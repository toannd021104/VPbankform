<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VPBank - Cập Nhật CRM & Log Tương Tác</title>
    <link rel="stylesheet" href="styles.css" />

    <!-- Supabase SDK v2 (UMD) -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
    <!-- Supabase inline config for Case 2 -->
    <script>
      window.__SB_URL__ =
        window.__SB_URL__ || "https://hjoislprylonxnmawbwo.supabase.co";
      window.__SB_ANON__ =
        window.__SB_ANON__ ||
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imhqb2lzbHByeWxvbnhubWF3YndvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5MDA2MzIsImV4cCI6MjA3NzQ3NjYzMn0._ZzZBYxpynKTM_Xw8-Jf8Wi53cJiTeE92u86osLIhEE";
      window.__ROW_ID__ = window.__ROW_ID__ || "vpbank_crm_update_shared_form";
      window.__TABLE__ = window.__TABLE__ || "crm_forms"; /* public.crm_forms */
    </script>
  </head>
  <body>
    <div class="container">
      <form id="crmUpdateForm" class="vpbank-form" novalidate>
        <div class="form-header">
          <h1>Cập Nhật CRM & Log Tương Tác</h1>
          <p>Hệ thống chăm sóc khách hàng - Customer Service</p>
        </div>

        <!-- Wizard Progress -->
        <div class="wizard-progress">
          <div class="wizard-steps">
            <div class="wizard-step is-active" data-step="1">Thông tin KH</div>
            <div class="wizard-step" data-step="2">Tương tác</div>
            <div class="wizard-step" data-step="3">Giải quyết & Đánh giá</div>
          </div>
          <div class="wizard-bar">
            <div class="wizard-bar-fill" style="width: 33%"></div>
          </div>
        </div>

        <!-- STEP 1: Customer Information -->
        <section class="wizard-step-pane" data-step="1">
          <div class="form-section">
            <h2>Thông Tin Khách Hàng</h2>

            <div class="form-row">
              <div class="form-group">
                <label for="customerName">Họ và Tên</label>
                <input type="text" id="customerName" name="customerName" />
              </div>

              <div class="form-group">
                <label for="customerId">Mã Khách Hàng</label>
                <input type="text" id="customerId" name="customerId" />
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="phoneNumber">Số Điện Thoại</label>
                <input type="tel" id="phoneNumber" name="phoneNumber" />
              </div>

              <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" />
              </div>
            </div>

            <div class="form-group">
              <label for="address">Địa Chỉ</label>
              <textarea
                id="address"
                name="address"
                placeholder="Cập nhật địa chỉ mới nếu có thay đổi"
              ></textarea>
            </div>
          </div>

          <div class="form-actions">
            <button type="button" class="btn-primary wizard-next">
              Tiếp tục
            </button>
          </div>
        </section>

        <!-- STEP 2: Interaction Details -->
        <section class="wizard-step-pane is-hidden" data-step="2">
          <div class="form-section">
            <h2>Chi Tiết Tương Tác</h2>

            <div class="form-row">
              <div class="form-group">
                <label for="interactionType">Loại Tương Tác</label>
                <select id="interactionType" name="interactionType">
                  <option value="">-- Chọn loại --</option>
                  <option value="call">Cuộc gọi</option>
                  <option value="email">Email</option>
                  <option value="visit">Gặp trực tiếp</option>
                  <option value="chat">Chat online</option>
                  <option value="sms">SMS</option>
                </select>
              </div>

              <div class="form-group">
                <label for="interactionDate">Ngày Tương Tác</label>
                <input
                  type="date"
                  id="interactionDate"
                  name="interactionDate"
                />
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="interactionTime">Thời Gian</label>
                <input
                  type="time"
                  id="interactionTime"
                  name="interactionTime"
                />
              </div>

              <div class="form-group">
                <label for="duration">Thời Lượng (phút)</label>
                <input
                  type="number"
                  id="duration"
                  name="duration"
                  min="0"
                  placeholder="Thời gian tương tác"
                />
              </div>
            </div>

            <div class="form-group">
              <label for="agentName">Tên Nhân Viên</label>
              <input type="text" id="agentName" name="agentName" />
            </div>
          </div>

          <div class="form-actions">
            <button type="button" class="btn-secondary wizard-prev">
              Quay lại
            </button>
            <button type="button" class="btn-primary wizard-next">
              Tiếp tục
            </button>
          </div>
        </section>

        <!-- STEP 3: Issue, Resolution & Satisfaction -->
        <section class="wizard-step-pane is-hidden" data-step="3">
          <!-- Issue & Resolution -->
          <div class="form-section">
            <h2>Vấn Đề & Giải Quyết</h2>

            <div class="form-group">
              <label for="issueCategory">Danh Mục Vấn Đề</label>
              <select id="issueCategory" name="issueCategory">
                <option value="">-- Chọn danh mục --</option>
                <option value="account">Tài khoản</option>
                <option value="card">Thẻ</option>
                <option value="loan">Vay vốn</option>
                <option value="transaction">Giao dịch</option>
                <option value="complaint">Khiếu nại</option>
                <option value="information">Tư vấn thông tin</option>
                <option value="service">Dịch vụ</option>
                <option value="other">Khác</option>
              </select>
            </div>

            <div class="form-group">
              <label for="issueDescription">Mô Tả Vấn Đề</label>
              <textarea
                id="issueDescription"
                name="issueDescription"
                placeholder="Mô tả chi tiết vấn đề khách hàng gặp phải..."
              ></textarea>
            </div>

            <div class="form-group">
              <label for="resolutionStatus">Trạng Thái Xử Lý</label>
              <select id="resolutionStatus" name="resolutionStatus">
                <option value="">-- Chọn trạng thái --</option>
                <option value="resolved">Đã giải quyết</option>
                <option value="pending">Đang xử lý</option>
                <option value="escalated">Đã chuyển lên cấp trên</option>
                <option value="cancelled">Đã hủy</option>
              </select>
            </div>

            <div class="form-group">
              <label for="resolutionDetails">Chi Tiết Giải Quyết</label>
              <textarea
                id="resolutionDetails"
                name="resolutionDetails"
                placeholder="Mô tả cách giải quyết hoặc bước tiếp theo..."
              ></textarea>
            </div>
          </div>

          <!-- Customer Satisfaction -->
          <div class="form-section">
            <h2>Đánh Giá Khách Hàng</h2>

            <div class="form-row">
              <div class="form-group">
                <label for="satisfactionRating">Mức Độ Hài Lòng</label>
                <select id="satisfactionRating" name="satisfactionRating">
                  <option value="">-- Chọn --</option>
                  <option value="5">⭐⭐⭐⭐⭐ Rất hài lòng</option>
                  <option value="4">⭐⭐⭐⭐ Hài lòng</option>
                  <option value="3">⭐⭐⭐ Bình thường</option>
                  <option value="2">⭐⭐ Không hài lòng</option>
                  <option value="1">⭐ Rất không hài lòng</option>
                </select>
              </div>

              <div class="form-group">
                <label for="followUpRequired">Cần Theo Dõi</label>
                <select id="followUpRequired" name="followUpRequired">
                  <option value="">-- Chọn --</option>
                  <option value="yes">Có</option>
                  <option value="no">Không</option>
                </select>
              </div>
            </div>

            <div class="form-group">
              <label for="followUpDate">Ngày Theo Dõi</label>
              <input type="date" id="followUpDate" name="followUpDate" />
            </div>
          </div>

          <!-- Additional Notes -->
          <div class="form-section">
            <h2>Ghi Chú</h2>

            <div class="form-group">
              <label for="notes">Ghi Chú Thêm</label>
              <textarea
                id="notes"
                name="notes"
                placeholder="Các thông tin bổ sung, lưu ý đặc biệt..."
              ></textarea>
            </div>

            <div class="form-group">
              <label for="tags">Tags (phân cách bằng dấu phẩy)</label>
              <input
                type="text"
                id="tags"
                name="tags"
                placeholder="VIP, urgent, follow-up"
              />
            </div>
          </div>

          <div class="form-actions">
            <button type="button" class="btn-secondary" id="clearBtn">
              Xóa Form
            </button>
            <button type="button" class="btn-secondary wizard-prev">
              Quay lại
            </button>
            <button type="submit" class="btn-primary">Gửi đơn</button>
          </div>
        </section>
      </form>
    </div>

    <script src="script.js"></script>
  </body>
</html>
